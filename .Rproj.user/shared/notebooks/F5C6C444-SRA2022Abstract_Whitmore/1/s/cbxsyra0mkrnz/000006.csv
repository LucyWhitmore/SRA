"0","#ABCD4pt0/"
"0","#ABCD3pt0/ABCDStudyNDA/"
"0",""
"0","qc<- rio::import(""/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_fsurfqc01.txt"")%>% #changed from freesqc01.txt"
"0","  filter(!collection_title==""collection_title"") %>%"
"0","  select(src_subject_id, eventname, fsqc_qc)  %>%"
"0","  mutate(src_subject_id=as.factor(src_subject_id),"
"0","         fsqc_qc=as.numeric(fsqc_qc))%>%"
"0","  filter(eventname==""baseline_year_1_arm_1"", fsqc_qc==1)"
"0",""
"0","qc_3pt0 <- rio::import(""/Volumes/devbrainlab/ABCD_Data/ABCD3pt0/ABCDStudyNDA/freesqc01.txt"")%>% #changed from freesqc01.txt"
"0","  filter(!collection_title==""collection_title"") %>%"
"0","  select(src_subject_id, eventname, fsqc_qc)  %>%"
"0","  mutate(src_subject_id=as.factor(src_subject_id),"
"0","         fsqc_qc=as.numeric(fsqc_qc))%>%"
"0","  filter(eventname==""baseline_year_1_arm_1"", fsqc_qc==1)"
"0",""
"0","brainconn1<-rio::import(""/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/mrirscor02.txt"") %>%"
"0","  filter(!collection_title==""collection_title"") %>%"
"0","  select(src_subject_id, eventname,rsfmri_cor_ngd_fopa_scs_aalh,"
"0","         rsfmri_cor_ngd_fopa_scs_aarh) %>%"
"0","  mutate(src_subject_id=as.factor(src_subject_id),"
"0","         rsfmri_cor_ngd_fopa_scs_aalh=as.numeric(rsfmri_cor_ngd_fopa_scs_aalh),"
"0","         rsfmri_cor_ngd_fopa_scs_aarh=as.numeric(rsfmri_cor_ngd_fopa_scs_aarh))%>%"
"0","  filter(eventname==""baseline_year_1_arm_1"", "
"0","         !is.na(rsfmri_cor_ngd_fopa_scs_aalh),"
"0","         !is.na(rsfmri_cor_ngd_fopa_scs_aarh),"
"0","         src_subject_id %in% qc_3pt0$src_subject_id) %>% #changed"
"0","  filter(between(rsfmri_cor_ngd_fopa_scs_aalh, quantile(rsfmri_cor_ngd_fopa_scs_aalh, .0025), quantile(rsfmri_cor_ngd_fopa_scs_aalh, .9975)),"
"0","         between(rsfmri_cor_ngd_fopa_scs_aarh, quantile(rsfmri_cor_ngd_fopa_scs_aarh, .0025), quantile(rsfmri_cor_ngd_fopa_scs_aarh, .9975)))"
"2","|--------------------------------------------------|
|"
"2","====="
"2","==="
"2","==="
"2","=="
"2","==="
"2","==="
"2","==="
"2","==="
"2","=="
"2","==="
"2","==="
"2","==="
"2","=="
"2","==="
"2","==="
"2","==="
"2","==="
"2","|
"
"0","brainconn2<-rio::import(""/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_betnet02.txt"") %>%"
"0","  filter(!collection_title==""collection_title"") %>%"
"0","  select(src_subject_id, eventname, rsfmri_c_ngd_dt_ngd_fo, rsfmri_c_ngd_ntpoints)%>%"
"0","  mutate(src_subject_id=as.factor(src_subject_id),"
"0","         rsfmri_c_ngd_dt_ngd_fo=as.numeric(rsfmri_c_ngd_dt_ngd_fo),"
"0","         rsfmri_c_ngd_ntpoints=as.numeric(rsfmri_c_ngd_ntpoints))%>%"
"0","  filter(eventname==""baseline_year_1_arm_1"", "
"0","         rsfmri_c_ngd_ntpoints>375, "
"0","         src_subject_id %in% qc_3pt0$src_subject_id, !is.na(rsfmri_c_ngd_dt_ngd_fo)) %>% #changed to alternate_qc"
"0","  filter(between(rsfmri_c_ngd_dt_ngd_fo, quantile(rsfmri_c_ngd_dt_ngd_fo, .0025), quantile(rsfmri_c_ngd_dt_ngd_fo, .9975)))"
"2","|--------------------------------------------------|
|"
"2","====="
"2","==="
"2","==="
"2","=="
"2","==="
"2","==="
"2","==="
"2","==="
"2","=="
"2","==="
"2","==="
"2","==="
"2","=="
"2","==="
"2","==="
"2","==="
"2","==="
"2","|
"
"0","#Adding delay discounting here, w/ manual exclusion"
"0","delay_data <- rio::import(""/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_yddss01.txt"")%>%"
"0","  filter(!collection_title==""collection_title"") %>%"
"0","  select(src_subject_id, interview_age, eventname, ddis_scr_val_immedcho,"
"0","         ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da,"
"0","         ddis_scr_val_indif_pnt_1week,ddis_scr_val_indif_pnt_1mth, ddis_scr_val_indif_pnt_3mth,"
"0","         ddis_scr_val_indif_pnt_1yr,ddis_scr_val_indif_pnt_5yr)%>%"
"0","  mutate(src_subject_id=as.factor(src_subject_id),"
"0","         interview_age=as.numeric(interview_age),"
"0","         ddis_scr_val_immedcho = as.numeric(ddis_scr_val_immedcho),"
"0","         ddis_scr_val_indif_pnt_1mth=as.numeric(ddis_scr_val_indif_pnt_1mth))%>%"
"0","  filter(eventname==""1_year_follow_up_y_arm_1"")"
"0",""
"0","cols.num <- c(""ddis_scr_val_indif_point_6h"", ""ddis_scr_val_indif_pnt_1da"",""ddis_scr_val_indif_pnt_1week"", ""ddis_scr_val_indif_pnt_1mth"", ""ddis_scr_val_indif_pnt_3mth"", ""ddis_scr_val_indif_pnt_1yr"", ""ddis_scr_val_indif_pnt_5yr"")"
"0","delay_data[cols.num] <- sapply(delay_data[cols.num],as.numeric)"
"0","sapply(delay_data, class)"
"1","              src_subject_id "
"1","               interview_age "
"1","                   eventname "
"1","       ddis_scr_val_immedcho "
"1"," ddis_scr_val_indif_point_6h "
"1","
"
"1","                    ""factor"" "
"1","                   ""numeric"" "
"1","                 ""character"" "
"1","                   ""numeric"" "
"1","                   ""numeric"" "
"1","
"
"1","  ddis_scr_val_indif_pnt_1da "
"1","ddis_scr_val_indif_pnt_1week "
"1"," ddis_scr_val_indif_pnt_1mth "
"1"," ddis_scr_val_indif_pnt_3mth "
"1","  ddis_scr_val_indif_pnt_1yr "
"1","
"
"1","                   ""numeric"" "
"1","                   ""numeric"" "
"1","                   ""numeric"" "
"1","                   ""numeric"" "
"1","                   ""numeric"" "
"1","
"
"1","  ddis_scr_val_indif_pnt_5yr "
"1","
"
"1","                   ""numeric"" "
"1","
"
"0","#delay expressed as proportion of maximum delay"
"0","#subjective value expressed as proportion of nominal amount (subjective value divided by actual, delayed amount)"
"0","    d1 = .75/1825"
"0","    d2 = 6/1825"
"0","    d3 = 23/1825"
"0","    d4 = 60/1825"
"0","    d5 = 275/1825"
"0","    d6 = 1460/1825"
"0",""
"0","delay_data <- delay_data %>% "
"0","  mutate(crit_1 = ((ddis_scr_val_indif_pnt_1da - ddis_scr_val_indif_point_6h) > .2) |"
"0","((ddis_scr_val_indif_pnt_1week - ddis_scr_val_indif_pnt_1da) > .2) |"
"0","((ddis_scr_val_indif_pnt_1mth - ddis_scr_val_indif_pnt_1week) > .2) |"
"0","((ddis_scr_val_indif_pnt_3mth - ddis_scr_val_indif_pnt_1mth) > .2) |"
"0","((ddis_scr_val_indif_pnt_1yr - ddis_scr_val_indif_pnt_3mth) > .2) |"
"0","((ddis_scr_val_indif_pnt_5yr - ddis_scr_val_indif_pnt_1yr) > .2)) %>% "
"0","  mutate(crit_2 = (ddis_scr_val_indif_pnt_5yr > (ddis_scr_val_indif_point_6h-.1))) %>% "
"0","  mutate(exclude = crit_1 & crit_2) %>% "
"0","  filter(exclude==""FALSE"") %>%  #end exclusion, start calculating AUC"
"0","  drop_na(ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da, ddis_scr_val_indif_pnt_1week, ddis_scr_val_indif_pnt_1mth,"
"0","          ddis_scr_val_indif_pnt_3mth, ddis_scr_val_indif_pnt_1yr, ddis_scr_val_indif_pnt_5yr) %>% "
"0","      mutate(dd_int1_2 = d1*((ddis_scr_val_indif_point_6h/100 - ddis_scr_val_indif_pnt_1da/100)/2),"
"0","             dd_int2_2 = d2*((ddis_scr_val_indif_pnt_1da/100 - ddis_scr_val_indif_pnt_1week/100)/2),"
"0","             dd_int3_2 = d3*((ddis_scr_val_indif_pnt_1week/100 - ddis_scr_val_indif_pnt_1mth/100)/2),"
"0","             dd_int4_2 = d4*((ddis_scr_val_indif_pnt_1mth/100 - ddis_scr_val_indif_pnt_3mth/100)/2),"
"0","             dd_int5_2 = d5*((ddis_scr_val_indif_pnt_3mth/100 - ddis_scr_val_indif_pnt_1yr/100)/2),"
"0","             dd_int6_2 = d6*((ddis_scr_val_indif_pnt_1yr/100 - ddis_scr_val_indif_pnt_5yr/100)/2),"
"0","             auc_2 = dd_int1_2 + dd_int2_2 + dd_int3_2 + dd_int4_2 + dd_int5_2 + dd_int6_2) %>% "
"0","     filter(auc_2 >= 0) %>%  #end AUC, calculate mean indifference point"
"0","     mutate(mean_indifference = rowMeans(select(., c(ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da, ddis_scr_val_indif_pnt_1week,"
"0","                                                     ddis_scr_val_indif_pnt_1mth, ddis_scr_val_indif_pnt_3mth, ddis_scr_val_indif_pnt_1yr,"
"0","                                                     ddis_scr_val_indif_pnt_5yr))))"
"0","##"
"0",""
"0","cashchoice <- rio::import(""/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/cct01.txt"")%>%"
"0","  filter(!collection_title==""collection_title"") %>%"
"0","    select(src_subject_id, interview_age, eventname, sex, cash_choice_task)%>%"
"0","  mutate(src_subject_id=as.factor(src_subject_id),"
"0","         interview_age=as.numeric(interview_age), cash_choice_task=as.numeric(cash_choice_task)) %>%"
"0","  filter(cash_choice_task!=3)"
"0",""
"0",""
"0","rhds<-rio::import(""/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_rhds01.txt"") %>%"
"0","  filter(!collection_title==""collection_title"") %>%"
"0","  select(src_subject_id, eventname, reshist_addr1_adi_perc)%>%"
"0","  mutate(src_subject_id=as.factor(src_subject_id),"
"0","         reshist_addr1_adi_perc=as.numeric(reshist_addr1_adi_perc))%>%"
"0","  filter(eventname==""baseline_year_1_arm_1"")"
"2","|--------------------------------------------------|
|"
"2","=="
"2","="
"2","=="
"2","="
"2","="
"2","="
"2","=="
"2","="
"2","="
"2","=="
"2","="
"2","="
"2","="
"2","=="
"2","="
"2","="
"2","=="
"2","="
"2","="
"2","="
"2","=="
"2","="
"2","="
"2","=="
"2","="
"2","="
"2","="
"2","=="
"2","="
"2","="
"2","=="
"2","="
"2","="
"2","="
"2","=="
"2","="
"2","="
"2","=="
"2","|
"
"0","famadversity<-rio::import(""/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_lpds01.txt"") %>%"
"0","  filter(!collection_title==""collection_title"") %>%"
"0","  select(src_subject_id, eventname,demo_fam_exp1_v2_l,demo_fam_exp2_v2_l,"
"0","         demo_fam_exp3_v2_l,demo_fam_exp4_v2_l,demo_fam_exp5_v2_l,"
"0","         demo_fam_exp6_v2_l,demo_fam_exp7_v2_l)%>%"
"0","  mutate(src_subject_id=as.factor(src_subject_id),"
"0","         demo_fam_exp1_v2_l=as.numeric(demo_fam_exp1_v2_l),"
"0","         demo_fam_exp2_v2_l=as.numeric(demo_fam_exp2_v2_l),"
"0","         demo_fam_exp3_v2_l=as.numeric(demo_fam_exp3_v2_l),"
"0","         demo_fam_exp4_v2_l=as.numeric(demo_fam_exp4_v2_l),"
"0","         demo_fam_exp5_v2_l=as.numeric(demo_fam_exp5_v2_l),"
"0","         demo_fam_exp6_v2_l=as.numeric(demo_fam_exp6_v2_l),"
"0","         demo_fam_exp7_v2_l=as.numeric(demo_fam_exp7_v2_l))%>%"
"0","  filter(eventname==""1_year_follow_up_y_arm_1"","
"0","         !demo_fam_exp1_v2_l==777,"
"0","         !demo_fam_exp2_v2_l==777,"
"0","         !demo_fam_exp3_v2_l==777,"
"0","         !demo_fam_exp4_v2_l==777,"
"0","         !demo_fam_exp5_v2_l==777,"
"0","         !demo_fam_exp6_v2_l==777,"
"0","         !demo_fam_exp7_v2_l==777)"
"2","|--------------------------------------------------|
|"
"2","==="
"2","=="
"2","=="
"2","="
"2","=="
"2","=="
"2","=="
"2","=="
"2","="
"2","=="
"2","=="
"2","=="
"2","=="
"2","="
"2","=="
"2","=="
"2","=="
"2","="
"2","=="
"2","=="
"2","=="
"2","=="
"2","="
"2","=="
"2","=="
"2","=="
"2","=="
"2","|
"
"0","famadversity$sum <- rowSums(famadversity[,3:9])"
"0",""
"0",""
"0","brainconn1<-brainconn1 %>%"
"0","  select(-eventname) "
"0","brainconn2<-brainconn2 %>%"
"0","  select(-eventname) "
"0","famadversity<-famadversity %>%"
"0","  select(-eventname) "
"0","rhds<-rhds %>%"
"0","  select(-eventname) "
"0","#tempdisc<-tempdisc %>%"
"0","#  select(-eventname)"
"0","cashchoice<-cashchoice %>%"
"0","  select(-eventname)"
"0","delay_data<-delay_data %>%"
"0","  select(-eventname)"
"0",""
"0"," # Combine datasets"
"0","combineddata<-left_join(brainconn1,brainconn2)"
"2","Joining, by = ""src_subject_id""
"
"0","combineddata<-left_join(combineddata,famadversity)"
"2","Joining, by = ""src_subject_id""
"
"0","combineddata<-left_join(combineddata,rhds)"
"2","Joining, by = ""src_subject_id""
"
"0","combineddata<-left_join(combineddata,delay_data)"
"2","Joining, by = ""src_subject_id""
"
"0","combineddata<-left_join(combineddata,cashchoice, by = ""src_subject_id"")"
"0",""
"0","#combinedata_delay <- left_join(combineddata,delay_data, by = ""src_subject_id"")"
"0",""
"0","# Take a subset"
"0","random_rows <- sample(5000)"
"0","subset<-combineddata[random_rows, ]"
"0",""
