new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
lapply(list.of.packages, library, character.only = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
delay_data <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_yddss01.txt")
#convert from character to numeric
cols.num <- c("ddis_scr_val_indif_point_6h", "ddis_scr_val_indif_pnt_1da","ddis_scr_val_indif_pnt_1week", "ddis_scr_val_indif_pnt_1mth", "ddis_scr_val_indif_pnt_3mth", "ddis_scr_val_indif_pnt_1yr", "ddis_scr_val_indif_pnt_5yr")
delay_data[cols.num] <- sapply(delay_data[cols.num],as.numeric)
sapply(delay_data, class)
#run criteria
delay_data_exclude <- delay_data %>%
mutate(crit_1 = ((ddis_scr_val_indif_pnt_1da - ddis_scr_val_indif_point_6h) > .2) |
((ddis_scr_val_indif_pnt_1week - ddis_scr_val_indif_pnt_1da) > .2) |
((ddis_scr_val_indif_pnt_1mth - ddis_scr_val_indif_pnt_1week) > .2) |
((ddis_scr_val_indif_pnt_3mth - ddis_scr_val_indif_pnt_1mth) > .2) |
((ddis_scr_val_indif_pnt_1yr - ddis_scr_val_indif_pnt_3mth) > .2) |
((ddis_scr_val_indif_pnt_5yr - ddis_scr_val_indif_pnt_1yr) > .2)) %>%
mutate(crit_2 = (ddis_scr_val_indif_pnt_5yr > (ddis_scr_val_indif_point_6h-.1))) %>%
mutate(exclude = crit_1 & crit_2)
275/365
1460/365
.75/365
6/365
60/365
90/365
23/365
60/365
275/365
1460/365
delay_data_exclude <- delay_data_exclude %>%
mutate(dd_int1 = ddis_scr_val_indif_point_6h + ddis_scr_val_indif_pnt_1da*0.002054794520547945,
dd_int2 = ddis_scr_val_indif_pnt_1da + ddis_scr_val_indif_pnt_1week*0.01643835616438356,
dd_int3 = ddis_scr_val_indif_pnt_1week + ddis_scr_val_indif_pnt_1mth*0.06301369863013699,
dd_int4 = ddis_scr_val_indif_pnt_1mth + ddis_scr_val_indif_pnt_3mth*0.1643835616438356,
dd_int5 = ddis_scr_val_indif_pnt_3mth + ddis_scr_val_indif_pnt_1yr*0.7534246575342466,
dd_int6 = ddis_scr_val_indif_pnt_1yr + ddis_scr_val_indif_pnt_5yr*4.0,
auc = sum(dd_int1, dd_int2, dd_int3, dd_int4, dd_int5, dd_int6))
delay_data_exclude_na <- delay_data_exclude %>%
drop_na(ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da, ddis_scr_val_indif_pnt_1week, ddis_scr_val_indif_pnt_1mth,
ddis_scr_val_indif_pnt_3mth, ddis_scr_val_indif_pnt_1yr, ddis_scr_val_indif_pnt_5yr)
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(dd_int1 = ddis_scr_val_indif_point_6h + ddis_scr_val_indif_pnt_1da*0.002054794520547945,
dd_int2 = ddis_scr_val_indif_pnt_1da + ddis_scr_val_indif_pnt_1week*0.01643835616438356,
dd_int3 = ddis_scr_val_indif_pnt_1week + ddis_scr_val_indif_pnt_1mth*0.06301369863013699,
dd_int4 = ddis_scr_val_indif_pnt_1mth + ddis_scr_val_indif_pnt_3mth*0.1643835616438356,
dd_int5 = ddis_scr_val_indif_pnt_3mth + ddis_scr_val_indif_pnt_1yr*0.7534246575342466,
dd_int6 = ddis_scr_val_indif_pnt_1yr + ddis_scr_val_indif_pnt_5yr*4.0,
auc = sum(dd_int1, dd_int2, dd_int3, dd_int4, dd_int5, dd_int6))
View(delay_data_exclude_na)
delay_data_exclude_na <- delay_data_exclude %>%
drop_na(ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da, ddis_scr_val_indif_pnt_1week, ddis_scr_val_indif_pnt_1mth,
ddis_scr_val_indif_pnt_3mth, ddis_scr_val_indif_pnt_1yr, ddis_scr_val_indif_pnt_5yr) %>%
filter(exclude=="FALSE")
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(dd_int1 = ddis_scr_val_indif_point_6h + ddis_scr_val_indif_pnt_1da*0.002054794520547945,
dd_int2 = ddis_scr_val_indif_pnt_1da + ddis_scr_val_indif_pnt_1week*0.01643835616438356,
dd_int3 = ddis_scr_val_indif_pnt_1week + ddis_scr_val_indif_pnt_1mth*0.06301369863013699,
dd_int4 = ddis_scr_val_indif_pnt_1mth + ddis_scr_val_indif_pnt_3mth*0.1643835616438356,
dd_int5 = ddis_scr_val_indif_pnt_3mth + ddis_scr_val_indif_pnt_1yr*0.7534246575342466,
dd_int6 = ddis_scr_val_indif_pnt_1yr + ddis_scr_val_indif_pnt_5yr*4.0,
auc = sum(dd_int1, dd_int2, dd_int3, dd_int4, dd_int5, dd_int6))
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(dd_int1 = ddis_scr_val_indif_point_6h + ddis_scr_val_indif_pnt_1da*0.002054794520547945,
dd_int2 = ddis_scr_val_indif_pnt_1da + ddis_scr_val_indif_pnt_1week*0.01643835616438356,
dd_int3 = ddis_scr_val_indif_pnt_1week + ddis_scr_val_indif_pnt_1mth*0.06301369863013699,
dd_int4 = ddis_scr_val_indif_pnt_1mth + ddis_scr_val_indif_pnt_3mth*0.1643835616438356,
dd_int5 = ddis_scr_val_indif_pnt_3mth + ddis_scr_val_indif_pnt_1yr*0.7534246575342466,
dd_int6 = ddis_scr_val_indif_pnt_1yr + ddis_scr_val_indif_pnt_5yr*4.0,
auc = rowSums(dd_int1, dd_int2, dd_int3, dd_int4, dd_int5, dd_int6))
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(dd_int1 = ddis_scr_val_indif_point_6h + ddis_scr_val_indif_pnt_1da*0.002054794520547945,
dd_int2 = ddis_scr_val_indif_pnt_1da + ddis_scr_val_indif_pnt_1week*0.01643835616438356,
dd_int3 = ddis_scr_val_indif_pnt_1week + ddis_scr_val_indif_pnt_1mth*0.06301369863013699,
dd_int4 = ddis_scr_val_indif_pnt_1mth + ddis_scr_val_indif_pnt_3mth*0.1643835616438356,
dd_int5 = ddis_scr_val_indif_pnt_3mth + ddis_scr_val_indif_pnt_1yr*0.7534246575342466,
dd_int6 = ddis_scr_val_indif_pnt_1yr + ddis_scr_val_indif_pnt_5yr*4.0,
auc = rowSums(select(dd_int1, dd_int2, dd_int3, dd_int4, dd_int5, dd_int6)))
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(dd_int1 = ddis_scr_val_indif_point_6h + ddis_scr_val_indif_pnt_1da*0.002054794520547945,
dd_int2 = ddis_scr_val_indif_pnt_1da + ddis_scr_val_indif_pnt_1week*0.01643835616438356,
dd_int3 = ddis_scr_val_indif_pnt_1week + ddis_scr_val_indif_pnt_1mth*0.06301369863013699,
dd_int4 = ddis_scr_val_indif_pnt_1mth + ddis_scr_val_indif_pnt_3mth*0.1643835616438356,
dd_int5 = ddis_scr_val_indif_pnt_3mth + ddis_scr_val_indif_pnt_1yr*0.7534246575342466,
dd_int6 = ddis_scr_val_indif_pnt_1yr + ddis_scr_val_indif_pnt_5yr*4.0,
auc = dd_int1 + dd_int2 + dd_int3 + dd_int4 + dd_int5 + dd_int6))
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(dd_int1 = ddis_scr_val_indif_point_6h + ddis_scr_val_indif_pnt_1da*0.002054794520547945,
dd_int2 = ddis_scr_val_indif_pnt_1da + ddis_scr_val_indif_pnt_1week*0.01643835616438356,
dd_int3 = ddis_scr_val_indif_pnt_1week + ddis_scr_val_indif_pnt_1mth*0.06301369863013699,
dd_int4 = ddis_scr_val_indif_pnt_1mth + ddis_scr_val_indif_pnt_3mth*0.1643835616438356,
dd_int5 = ddis_scr_val_indif_pnt_3mth + ddis_scr_val_indif_pnt_1yr*0.7534246575342466,
dd_int6 = ddis_scr_val_indif_pnt_1yr + ddis_scr_val_indif_pnt_5yr*4.0,
auc = dd_int1 + dd_int2 + dd_int3 + dd_int4 + dd_int5 + dd_int6)
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(dd_int1_2 = .75*((ddis_scr_val_indif_point_6h - ddis_scr_val_indif_pnt_1da)/2),
dd_int2_2 = 6*((ddis_scr_val_indif_pnt_1da - ddis_scr_val_indif_pnt_1week)/2),
dd_int3_2 = 23*((ddis_scr_val_indif_pnt_1week - ddis_scr_val_indif_pnt_1mth)/2),
dd_int4_2 = 60*((ddis_scr_val_indif_pnt_1mth - ddis_scr_val_indif_pnt_3mth)/2),
dd_int5_2 = 275*((ddis_scr_val_indif_pnt_3mth - ddis_scr_val_indif_pnt_1yr)/2),
dd_int6_2 = 1460*((ddis_scr_val_indif_pnt_1yr - ddis_scr_val_indif_pnt_5yr)/2),
auc_2 = dd_int1_2 + dd_int2_2 + dd_int3_2 + dd_int4_2 + dd_int5_2 + dd_int6_2)
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(mean_indifference = mean(ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da, ddis_scr_val_indif_pnt_1week, ddis_scr_val_indif_pnt_1mth, ddis_scr_val_indif_pnt_3mth, ddis_scr_val_indif_pnt_1yr, ddis_scr_val_indif_pnt_5yr))
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(mean_indifference = rowMeans(select(ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da, ddis_scr_val_indif_pnt_1week, ddis_scr_val_indif_pnt_1mth, ddis_scr_val_indif_pnt_3mth, ddis_scr_val_indif_pnt_1yr, ddis_scr_val_indif_pnt_5yr)))
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(mean_indifference = rowMeans(select(., c(ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da, ddis_scr_val_indif_pnt_1week, ddis_scr_val_indif_pnt_1mth, ddis_scr_val_indif_pnt_3mth, ddis_scr_val_indif_pnt_1yr, ddis_scr_val_indif_pnt_5yr))))
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(dd_int1_2 = .75*((ddis_scr_val_indif_point_6h/100 - ddis_scr_val_indif_pnt_1da/100)/2),
dd_int2_2 = 6*((ddis_scr_val_indif_pnt_1da/100 - ddis_scr_val_indif_pnt_1week/100)/2),
dd_int3_2 = 23*((ddis_scr_val_indif_pnt_1week/100 - ddis_scr_val_indif_pnt_1mth/100)/2),
dd_int4_2 = 60*((ddis_scr_val_indif_pnt_1mth/100 - ddis_scr_val_indif_pnt_3mth/100)/2),
dd_int5_2 = 275*((ddis_scr_val_indif_pnt_3mth/100 - ddis_scr_val_indif_pnt_1yr/100)/2),
dd_int6_2 = 1460*((ddis_scr_val_indif_pnt_1yr/100 - ddis_scr_val_indif_pnt_5yr/100)/2),
auc_2 = dd_int1_2 + dd_int2_2 + dd_int3_2 + dd_int4_2 + dd_int5_2 + dd_int6_2)
1/1825-.25/1825
.75/1825
d1 = .75/1825
d2 = 6/1825
d3 = 23/1825
d4 = 60/1825
d5 = 275/1825
d6 = 1460/1825
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(dd_int1_2 = d1*((ddis_scr_val_indif_point_6h/100 - ddis_scr_val_indif_pnt_1da/100)/2),
dd_int2_2 = d2*((ddis_scr_val_indif_pnt_1da/100 - ddis_scr_val_indif_pnt_1week/100)/2),
dd_int3_2 = d3*((ddis_scr_val_indif_pnt_1week/100 - ddis_scr_val_indif_pnt_1mth/100)/2),
dd_int4_2 = d4*((ddis_scr_val_indif_pnt_1mth/100 - ddis_scr_val_indif_pnt_3mth/100)/2),
dd_int5_2 = d5*((ddis_scr_val_indif_pnt_3mth/100 - ddis_scr_val_indif_pnt_1yr/100)/2),
dd_int6_2 = d6*((ddis_scr_val_indif_pnt_1yr/100 - ddis_scr_val_indif_pnt_5yr/100)/2),
auc_2 = dd_int1_2 + dd_int2_2 + dd_int3_2 + dd_int4_2 + dd_int5_2 + dd_int6_2)
sum(delay_data_exclude_na[,c("auc_2")]>0)
sum(delay_data_exclude_na[,c("ddis_scr_val_immedcho")]=3)
sum(delay_data_exclude_na[,c("ddis_scr_val_immedcho")]>2)
max(delay_data_exclude_na$auc_2)
min(delay_data_exclude_na$auc_2)
git remote add origin https://github.com/LucyWhitmore/SRA.git
git branch -M main
git push -u origin main
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(mean_indifference = rowMeans(select(., c(ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da, ddis_scr_val_indif_pnt_1week, ddis_scr_val_indif_pnt_1mth, ddis_scr_val_indif_pnt_3mth, ddis_scr_val_indif_pnt_1yr, ddis_scr_val_indif_pnt_5yr))))
cor(delay_data_exclude_na$mean_indifference, delay_data_exclude_na$auc)
cor(delay_data_exclude_na$mean_indifference, delay_data_exclude_na$auc_2)
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(dd_int1_div = ddis_scr_val_indif_point_6h/100 + ddis_scr_val_indif_pnt_1da/100*0.002054794520547945,
dd_int2_div = ddis_scr_val_indif_pnt_1da/100 + ddis_scr_val_indif_pnt_1week/100*0.01643835616438356,
dd_int3_div = ddis_scr_val_indif_pnt_1week/100 + ddis_scr_val_indif_pnt_1mth/100*0.06301369863013699,
dd_int4_div = ddis_scr_val_indif_pnt_1mth/100 + ddis_scr_val_indif_pnt_3mth/100*0.1643835616438356,
dd_int5_div = ddis_scr_val_indif_pnt_3mth/100 + ddis_scr_val_indif_pnt_1yr/100*0.7534246575342466,
dd_int6_div = ddis_scr_val_indif_pnt_1yr/100 + ddis_scr_val_indif_pnt_5yr/100*4.0,
auc_3 = dd_int1_div + dd_int2_div + dd_int3_div + dd_int4_div + dd_int5_div + dd_int6_div)
delay_data_exclude_na <- delay_data_exclude_na %>%
mutate(dd_int1_div = ddis_scr_val_indif_point_6h/100 + ddis_scr_val_indif_pnt_1da/100*d1,
dd_int2_div = ddis_scr_val_indif_pnt_1da/100 + ddis_scr_val_indif_pnt_1week/100*d2,
dd_int3_div = ddis_scr_val_indif_pnt_1week/100 + ddis_scr_val_indif_pnt_1mth/100*d3,
dd_int4_div = ddis_scr_val_indif_pnt_1mth/100 + ddis_scr_val_indif_pnt_3mth/100*d4,
dd_int5_div = ddis_scr_val_indif_pnt_3mth/100 + ddis_scr_val_indif_pnt_1yr/100*d5,
dd_int6_div = ddis_scr_val_indif_pnt_1yr/100 + ddis_scr_val_indif_pnt_5yr/100*d6,
auc_3 = dd_int1_div + dd_int2_div + dd_int3_div + dd_int4_div + dd_int5_div + dd_int6_div)
cor(delay_data_exclude_na$mean_indifference, delay_data_exclude_na$auc)
cor(delay_data_exclude_na$mean_indifference, delay_data_exclude_na$auc_2)
cor(delay_data_exclude_na$mean_indifference, delay_data_exclude_na$auc_3)
ggplot(delay_data_exclude_na, aes(x=auc_2) +
geom_histogram()
ggplot(delay_data_exclude_na, aes(x=auc_2)) +
geom_histogram()
delay_data_exclude_na_neg <- delay_data_exclude_na %>%
filter(auc >= 0)
delay_data_exclude_na_neg <- delay_data_exclude_na %>%
filter(auc_2 >= 0)
ggplot(delay_data_exclude_na_neg, aes(x=auc_2)) +
geom_histogram()
knitr::opts_chunk$set(echo = FALSE)
# Turn off scientific notation
options(scipen=999)
# Setting the seed sets the starting number used to generate a sequence of random numbers, which ensures that you get the same result if you start with that same seed each time you run the same process
set.seed(seed = 711711)
list.of.packages <- c("Hmisc","Rmisc","tidyr", "nlme", "caret",
"MASS","ggplot2","dplyr","lme4",
"MuMIn","mgcv","broom", "gratia",
"splines","psych","table1", "rio",
"skimr","magrittr","qwraps2", "sjPlot",
"discAUC")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
lapply(list.of.packages, library, character.only = TRUE)
qc<- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/freesqc01.txt")%>%
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname, fsqc_qc)  %>%
mutate(src_subject_id=as.factor(src_subject_id),
fsqc_qc=as.numeric(fsqc_qc))%>%
filter(eventname=="baseline_year_1_arm_1", fsqc_qc==1)
qc<- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_fsurfqc01.txt")%>% #changed from freesqc01.txt
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname, fsqc_qc)  %>%
mutate(src_subject_id=as.factor(src_subject_id),
fsqc_qc=as.numeric(fsqc_qc))%>%
filter(eventname=="baseline_year_1_arm_1", fsqc_qc==1)
brainconn1<-rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/mrirscor02.txt") %>%
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname,rsfmri_cor_ngd_fopa_scs_aalh,
rsfmri_cor_ngd_fopa_scs_aarh) %>%
mutate(src_subject_id=as.factor(src_subject_id),
rsfmri_cor_ngd_fopa_scs_aalh=as.numeric(rsfmri_cor_ngd_fopa_scs_aalh),
rsfmri_cor_ngd_fopa_scs_aarh=as.numeric(rsfmri_cor_ngd_fopa_scs_aarh))%>%
filter(eventname=="baseline_year_1_arm_1",
!is.na(rsfmri_cor_ngd_fopa_scs_aalh),
!is.na(rsfmri_cor_ngd_fopa_scs_aarh),
src_subject_id %in% qc$src_subject_id) %>%
filter(between(rsfmri_cor_ngd_fopa_scs_aalh, quantile(rsfmri_cor_ngd_fopa_scs_aalh, .0025), quantile(rsfmri_cor_ngd_fopa_scs_aalh, .9975)),
between(rsfmri_cor_ngd_fopa_scs_aarh, quantile(rsfmri_cor_ngd_fopa_scs_aarh, .0025), quantile(rsfmri_cor_ngd_fopa_scs_aarh, .9975)))
brainconn2<-rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_betnet02.txt") %>%
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname, rsfmri_c_ngd_dt_ngd_fo, rsfmri_c_ngd_ntpoints)%>%
mutate(src_subject_id=as.factor(src_subject_id),
rsfmri_c_ngd_dt_ngd_fo=as.numeric(rsfmri_c_ngd_dt_ngd_fo),
rsfmri_c_ngd_ntpoints=as.numeric(rsfmri_c_ngd_ntpoints))%>%
filter(eventname=="baseline_year_1_arm_1",
rsfmri_c_ngd_ntpoints>375,
src_subject_id %in% qc$src_subject_id, !is.na(rsfmri_c_ngd_dt_ngd_fo)) %>%
filter(between(rsfmri_c_ngd_dt_ngd_fo, quantile(rsfmri_c_ngd_dt_ngd_fo, .0025), quantile(rsfmri_c_ngd_dt_ngd_fo, .9975)))
delay_data <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_yddss01.txt")%>%
filter(!collection_title=="collection_title") %>%
select(src_subject_id, interview_age, eventname, ddis_scr_val_immedcho,
ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da,
ddis_scr_val_indif_pnt_1week,ddis_scr_val_indif_pnt_1mth, ddis_scr_val_indif_pnt_3mth,
ddis_scr_val_indif_pnt_1yr,ddis_scr_val_indif_pnt_5yr)%>%
mutate(src_subject_id=as.factor(src_subject_id),
interview_age=as.numeric(interview_age),
ddis_scr_val_immedcho = as.numeric(ddis_scr_val_immedcho),
ddis_scr_val_indif_pnt_1mth=as.numeric(ddis_scr_val_indif_pnt_1mth))%>%
filter(eventname=="1_year_follow_up_y_arm_1")
cols.num <- c("ddis_scr_val_indif_point_6h", "ddis_scr_val_indif_pnt_1da","ddis_scr_val_indif_pnt_1week", "ddis_scr_val_indif_pnt_1mth", "ddis_scr_val_indif_pnt_3mth", "ddis_scr_val_indif_pnt_1yr", "ddis_scr_val_indif_pnt_5yr")
delay_data[cols.num] <- sapply(delay_data[cols.num],as.numeric)
sapply(delay_data, class)
delay_data <- delay_data %>%
mutate(crit_1 = ((ddis_scr_val_indif_pnt_1da - ddis_scr_val_indif_point_6h) > .2) |
((ddis_scr_val_indif_pnt_1week - ddis_scr_val_indif_pnt_1da) > .2) |
((ddis_scr_val_indif_pnt_1mth - ddis_scr_val_indif_pnt_1week) > .2) |
((ddis_scr_val_indif_pnt_3mth - ddis_scr_val_indif_pnt_1mth) > .2) |
((ddis_scr_val_indif_pnt_1yr - ddis_scr_val_indif_pnt_3mth) > .2) |
((ddis_scr_val_indif_pnt_5yr - ddis_scr_val_indif_pnt_1yr) > .2)) %>%
mutate(crit_2 = (ddis_scr_val_indif_pnt_5yr > (ddis_scr_val_indif_point_6h-.1))) %>%
mutate(exclude = crit_1 & crit_2) %>%
filter(exclude=="FALSE") %>%  #end exclusion, start calculating AUC
drop_na(ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da, ddis_scr_val_indif_pnt_1week, ddis_scr_val_indif_pnt_1mth,
ddis_scr_val_indif_pnt_3mth, ddis_scr_val_indif_pnt_1yr, ddis_scr_val_indif_pnt_5yr) %>%
mutate(dd_int1_2 = d1*((ddis_scr_val_indif_point_6h/100 - ddis_scr_val_indif_pnt_1da/100)/2),
dd_int2_2 = d2*((ddis_scr_val_indif_pnt_1da/100 - ddis_scr_val_indif_pnt_1week/100)/2),
dd_int3_2 = d3*((ddis_scr_val_indif_pnt_1week/100 - ddis_scr_val_indif_pnt_1mth/100)/2),
dd_int4_2 = d4*((ddis_scr_val_indif_pnt_1mth/100 - ddis_scr_val_indif_pnt_3mth/100)/2),
dd_int5_2 = d5*((ddis_scr_val_indif_pnt_3mth/100 - ddis_scr_val_indif_pnt_1yr/100)/2),
dd_int6_2 = d6*((ddis_scr_val_indif_pnt_1yr/100 - ddis_scr_val_indif_pnt_5yr/100)/2),
auc_2 = dd_int1_2 + dd_int2_2 + dd_int3_2 + dd_int4_2 + dd_int5_2 + dd_int6_2) %>%
filter(auc_2 >= 0) %>%  #end AUC, calculate mean indifference point
mutate(mean_indifference = rowMeans(select(., c(ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da, ddis_scr_val_indif_pnt_1week,
ddis_scr_val_indif_pnt_1mth, ddis_scr_val_indif_pnt_3mth, ddis_scr_val_indif_pnt_1yr,
ddis_scr_val_indif_pnt_5yr))))
#delay expressed as proportion of maximum delay
#subjective value expressed as proportion of nominal amount (subjective value divided by actual, delayed amount)
d1 = .75/1825
d2 = 6/1825
d3 = 23/1825
d4 = 60/1825
d5 = 275/1825
d6 = 1460/1825
delay_data <- delay_data %>%
mutate(crit_1 = ((ddis_scr_val_indif_pnt_1da - ddis_scr_val_indif_point_6h) > .2) |
((ddis_scr_val_indif_pnt_1week - ddis_scr_val_indif_pnt_1da) > .2) |
((ddis_scr_val_indif_pnt_1mth - ddis_scr_val_indif_pnt_1week) > .2) |
((ddis_scr_val_indif_pnt_3mth - ddis_scr_val_indif_pnt_1mth) > .2) |
((ddis_scr_val_indif_pnt_1yr - ddis_scr_val_indif_pnt_3mth) > .2) |
((ddis_scr_val_indif_pnt_5yr - ddis_scr_val_indif_pnt_1yr) > .2)) %>%
mutate(crit_2 = (ddis_scr_val_indif_pnt_5yr > (ddis_scr_val_indif_point_6h-.1))) %>%
mutate(exclude = crit_1 & crit_2) %>%
filter(exclude=="FALSE") %>%  #end exclusion, start calculating AUC
drop_na(ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da, ddis_scr_val_indif_pnt_1week, ddis_scr_val_indif_pnt_1mth,
ddis_scr_val_indif_pnt_3mth, ddis_scr_val_indif_pnt_1yr, ddis_scr_val_indif_pnt_5yr) %>%
mutate(dd_int1_2 = d1*((ddis_scr_val_indif_point_6h/100 - ddis_scr_val_indif_pnt_1da/100)/2),
dd_int2_2 = d2*((ddis_scr_val_indif_pnt_1da/100 - ddis_scr_val_indif_pnt_1week/100)/2),
dd_int3_2 = d3*((ddis_scr_val_indif_pnt_1week/100 - ddis_scr_val_indif_pnt_1mth/100)/2),
dd_int4_2 = d4*((ddis_scr_val_indif_pnt_1mth/100 - ddis_scr_val_indif_pnt_3mth/100)/2),
dd_int5_2 = d5*((ddis_scr_val_indif_pnt_3mth/100 - ddis_scr_val_indif_pnt_1yr/100)/2),
dd_int6_2 = d6*((ddis_scr_val_indif_pnt_1yr/100 - ddis_scr_val_indif_pnt_5yr/100)/2),
auc_2 = dd_int1_2 + dd_int2_2 + dd_int3_2 + dd_int4_2 + dd_int5_2 + dd_int6_2) %>%
filter(auc_2 >= 0) %>%  #end AUC, calculate mean indifference point
mutate(mean_indifference = rowMeans(select(., c(ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da, ddis_scr_val_indif_pnt_1week,
ddis_scr_val_indif_pnt_1mth, ddis_scr_val_indif_pnt_3mth, ddis_scr_val_indif_pnt_1yr,
ddis_scr_val_indif_pnt_5yr))))
View(brainconn1)
qc_all <-rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_fsurfqc01.txt")%>% #changed from freesqc01.txt
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname, fsqc_qc)  %>%
mutate(src_subject_id=as.factor(src_subject_id),
fsqc_qc=as.numeric(fsqc_qc))%>%
filter(eventname=="baseline_year_1_arm_1")
View(qc_all)
qc_all <-rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_fsurfqc01.txt")
View(qc)
qc_all <-rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_fsurfqc01.txt")%>% #changed from freesqc01.txt
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname, fsqc_qc)  %>%
mutate(src_subject_id=as.factor(src_subject_id),
fsqc_qc=as.numeric(fsqc_qc))%>%
filter(eventname=="baseline_year_1_arm_1")
#fsqc_qc is NA for a bunch of people
brainconn1_test<-rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/mrirscor02.txt")
View(brainconn1_test)
qc_all <-rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_fsurfqc01.txt")%>% #changed from freesqc01.txt
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname)  %>% #, fsqc_qc
mutate(src_subject_id=as.factor(src_subject_id),
fsqc_qc=as.numeric(fsqc_qc))%>%
filter(eventname=="baseline_year_1_arm_1")
qc_all <-rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_fsurfqc01.txt")%>% #changed from freesqc01.txt
filter(!collection_title=="collection_title") %>%
#select(src_subject_id, eventname, fsqc_qc)  %>%
mutate(src_subject_id=as.factor(src_subject_id),
fsqc_qc=as.numeric(fsqc_qc))%>%
filter(eventname=="baseline_year_1_arm_1")
qc_3pt0 <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD3pt0/ABCDStudyNDA/abcd_fsurfqc01.txt")%>% #changed from freesqc01.txt
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname, fsqc_qc)  %>%
mutate(src_subject_id=as.factor(src_subject_id),
fsqc_qc=as.numeric(fsqc_qc))%>%
filter(eventname=="baseline_year_1_arm_1", fsqc_qc==1)
qc_3pt0 <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD3pt0/ABCDStudyNDA/freesqc01.txt")%>% #changed from freesqc01.txt
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname, fsqc_qc)  %>%
mutate(src_subject_id=as.factor(src_subject_id),
fsqc_qc=as.numeric(fsqc_qc))%>%
filter(eventname=="baseline_year_1_arm_1", fsqc_qc==1)
View(qc_3pt0)
qc_3pt0_all <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD3pt0/ABCDStudyNDA/freesqc01.txt")%>% #changed from freesqc01.txt
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname, fsqc_qc)  %>%
mutate(src_subject_id=as.factor(src_subject_id),
fsqc_qc=as.numeric(fsqc_qc))%>%
filter(eventname=="baseline_year_1_arm_1")
alternate_qc <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_imgincl01.txt")%>% #changed from freesqc01.txt
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname, imgincl_rsfmri_include)  %>%
mutate(src_subject_id=as.factor(src_subject_id),
imgincl_rsfmri_include=as.numeric(imgincl_rsfmri_include))%>%
filter(eventname=="baseline_year_1_arm_1", imgincl_rsfmri_include==1)
brainconn1<-rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/mrirscor02.txt") %>%
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname,rsfmri_cor_ngd_fopa_scs_aalh,
rsfmri_cor_ngd_fopa_scs_aarh) %>%
mutate(src_subject_id=as.factor(src_subject_id),
rsfmri_cor_ngd_fopa_scs_aalh=as.numeric(rsfmri_cor_ngd_fopa_scs_aalh),
rsfmri_cor_ngd_fopa_scs_aarh=as.numeric(rsfmri_cor_ngd_fopa_scs_aarh))%>%
filter(eventname=="baseline_year_1_arm_1",
!is.na(rsfmri_cor_ngd_fopa_scs_aalh),
!is.na(rsfmri_cor_ngd_fopa_scs_aarh),
src_subject_id %in% alternate_qc$src_subject_id) %>% #changed to alternatte_qc
filter(between(rsfmri_cor_ngd_fopa_scs_aalh, quantile(rsfmri_cor_ngd_fopa_scs_aalh, .0025), quantile(rsfmri_cor_ngd_fopa_scs_aalh, .9975)),
between(rsfmri_cor_ngd_fopa_scs_aarh, quantile(rsfmri_cor_ngd_fopa_scs_aarh, .0025), quantile(rsfmri_cor_ngd_fopa_scs_aarh, .9975)))
brainconn2<-rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_betnet02.txt") %>%
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname, rsfmri_c_ngd_dt_ngd_fo, rsfmri_c_ngd_ntpoints)%>%
mutate(src_subject_id=as.factor(src_subject_id),
rsfmri_c_ngd_dt_ngd_fo=as.numeric(rsfmri_c_ngd_dt_ngd_fo),
rsfmri_c_ngd_ntpoints=as.numeric(rsfmri_c_ngd_ntpoints))%>%
filter(eventname=="baseline_year_1_arm_1",
rsfmri_c_ngd_ntpoints>375,
src_subject_id %in% alternate_qc$src_subject_id, !is.na(rsfmri_c_ngd_dt_ngd_fo)) %>% #changed to alternate_qc
filter(between(rsfmri_c_ngd_dt_ngd_fo, quantile(rsfmri_c_ngd_dt_ngd_fo, .0025), quantile(rsfmri_c_ngd_dt_ngd_fo, .9975)))
delay_data <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_yddss01.txt")%>%
filter(!collection_title=="collection_title") %>%
select(src_subject_id, interview_age, eventname, ddis_scr_val_immedcho,
ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da,
ddis_scr_val_indif_pnt_1week,ddis_scr_val_indif_pnt_1mth, ddis_scr_val_indif_pnt_3mth,
ddis_scr_val_indif_pnt_1yr,ddis_scr_val_indif_pnt_5yr)%>%
mutate(src_subject_id=as.factor(src_subject_id),
interview_age=as.numeric(interview_age),
ddis_scr_val_immedcho = as.numeric(ddis_scr_val_immedcho),
ddis_scr_val_indif_pnt_1mth=as.numeric(ddis_scr_val_indif_pnt_1mth))%>%
filter(eventname=="1_year_follow_up_y_arm_1")
cols.num <- c("ddis_scr_val_indif_point_6h", "ddis_scr_val_indif_pnt_1da","ddis_scr_val_indif_pnt_1week", "ddis_scr_val_indif_pnt_1mth", "ddis_scr_val_indif_pnt_3mth", "ddis_scr_val_indif_pnt_1yr", "ddis_scr_val_indif_pnt_5yr")
delay_data[cols.num] <- sapply(delay_data[cols.num],as.numeric)
sapply(delay_data, class)
#delay expressed as proportion of maximum delay
#subjective value expressed as proportion of nominal amount (subjective value divided by actual, delayed amount)
d1 = .75/1825
d2 = 6/1825
d3 = 23/1825
d4 = 60/1825
d5 = 275/1825
d6 = 1460/1825
delay_data <- delay_data %>%
mutate(crit_1 = ((ddis_scr_val_indif_pnt_1da - ddis_scr_val_indif_point_6h) > .2) |
((ddis_scr_val_indif_pnt_1week - ddis_scr_val_indif_pnt_1da) > .2) |
((ddis_scr_val_indif_pnt_1mth - ddis_scr_val_indif_pnt_1week) > .2) |
((ddis_scr_val_indif_pnt_3mth - ddis_scr_val_indif_pnt_1mth) > .2) |
((ddis_scr_val_indif_pnt_1yr - ddis_scr_val_indif_pnt_3mth) > .2) |
((ddis_scr_val_indif_pnt_5yr - ddis_scr_val_indif_pnt_1yr) > .2)) %>%
mutate(crit_2 = (ddis_scr_val_indif_pnt_5yr > (ddis_scr_val_indif_point_6h-.1))) %>%
mutate(exclude = crit_1 & crit_2) %>%
filter(exclude=="FALSE") %>%  #end exclusion, start calculating AUC
drop_na(ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da, ddis_scr_val_indif_pnt_1week, ddis_scr_val_indif_pnt_1mth,
ddis_scr_val_indif_pnt_3mth, ddis_scr_val_indif_pnt_1yr, ddis_scr_val_indif_pnt_5yr) %>%
mutate(dd_int1_2 = d1*((ddis_scr_val_indif_point_6h/100 - ddis_scr_val_indif_pnt_1da/100)/2),
dd_int2_2 = d2*((ddis_scr_val_indif_pnt_1da/100 - ddis_scr_val_indif_pnt_1week/100)/2),
dd_int3_2 = d3*((ddis_scr_val_indif_pnt_1week/100 - ddis_scr_val_indif_pnt_1mth/100)/2),
dd_int4_2 = d4*((ddis_scr_val_indif_pnt_1mth/100 - ddis_scr_val_indif_pnt_3mth/100)/2),
dd_int5_2 = d5*((ddis_scr_val_indif_pnt_3mth/100 - ddis_scr_val_indif_pnt_1yr/100)/2),
dd_int6_2 = d6*((ddis_scr_val_indif_pnt_1yr/100 - ddis_scr_val_indif_pnt_5yr/100)/2),
auc_2 = dd_int1_2 + dd_int2_2 + dd_int3_2 + dd_int4_2 + dd_int5_2 + dd_int6_2) %>%
filter(auc_2 >= 0) %>%  #end AUC, calculate mean indifference point
mutate(mean_indifference = rowMeans(select(., c(ddis_scr_val_indif_point_6h, ddis_scr_val_indif_pnt_1da, ddis_scr_val_indif_pnt_1week,
ddis_scr_val_indif_pnt_1mth, ddis_scr_val_indif_pnt_3mth, ddis_scr_val_indif_pnt_1yr,
ddis_scr_val_indif_pnt_5yr))))
rhds<-rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_rhds01.txt") %>%
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname, reshist_addr1_adi_perc)%>%
mutate(src_subject_id=as.factor(src_subject_id),
reshist_addr1_adi_perc=as.numeric(reshist_addr1_adi_perc))%>%
filter(eventname=="baseline_year_1_arm_1")
famadversity<-rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_lpds01.txt") %>%
filter(!collection_title=="collection_title") %>%
select(src_subject_id, eventname,demo_fam_exp1_v2_l,demo_fam_exp2_v2_l,
demo_fam_exp3_v2_l,demo_fam_exp4_v2_l,demo_fam_exp5_v2_l,
demo_fam_exp6_v2_l,demo_fam_exp7_v2_l)%>%
mutate(src_subject_id=as.factor(src_subject_id),
demo_fam_exp1_v2_l=as.numeric(demo_fam_exp1_v2_l),
demo_fam_exp2_v2_l=as.numeric(demo_fam_exp2_v2_l),
demo_fam_exp3_v2_l=as.numeric(demo_fam_exp3_v2_l),
demo_fam_exp4_v2_l=as.numeric(demo_fam_exp4_v2_l),
demo_fam_exp5_v2_l=as.numeric(demo_fam_exp5_v2_l),
demo_fam_exp6_v2_l=as.numeric(demo_fam_exp6_v2_l),
demo_fam_exp7_v2_l=as.numeric(demo_fam_exp7_v2_l))%>%
filter(eventname=="1_year_follow_up_y_arm_1",
!demo_fam_exp1_v2_l==777,
!demo_fam_exp2_v2_l==777,
!demo_fam_exp3_v2_l==777,
!demo_fam_exp4_v2_l==777,
!demo_fam_exp5_v2_l==777,
!demo_fam_exp6_v2_l==777,
!demo_fam_exp7_v2_l==777)
famadversity$sum <- rowSums(famadversity[,3:9])
brainconn1<-brainconn1 %>%
select(-eventname)
brainconn2<-brainconn2 %>%
select(-eventname)
famadversity<-famadversity %>%
select(-eventname)
rhds<-rhds %>%
select(-eventname)
delay_data<-delay_data %>%
select(-eventname)
combineddata<-left_join(brainconn1,brainconn2)
combineddata<-left_join(combineddata,famadversity)
combineddata<-left_join(combineddata,rhds)
combineddata<-left_join(combineddata,delay_data)
random_rows <- sample(5000)
subset<-combineddata[random_rows, ]
str(subset)
null=lm(cash_choice_task ~ interview_age,
data=subset)
View(subset)
null=lm(auc_2 ~ interview_age,
data=subset)
summary(null)
ggplot(subset, aes(x=interview_age, y=auc_2)) + geom_point()
restingstate_fopa_acc_r=lm(auc_2 ~ #interview_age +
rsfmri_cor_ngd_fopa_scs_aarh,
data=subset)
summary(restingstate_fopa_acc_r)
restingstate_fopa_acc_l=lm(auc_2 ~ #interview_age +
rsfmri_cor_ngd_fopa_scs_aalh,
data=subset)
summary(restingstate_fopa_acc_l)
restingstate_default=lm(auc_2 ~ #interview_age +
rsfmri_c_ngd_dt_ngd_fo,
data=subset)
summary(restingstate_default)
deprivation=lm(auc_2 ~ rsfmri_cor_ngd_fopa_scs_aalh+
reshist_addr1_adi_perc,
data=subset)
summary(deprivation)
famadversitymod=lm(auc_2 ~ rsfmri_cor_ngd_fopa_scs_aalh+
sum,
data=subset)
summary(famadversitymod)
null=lm(auc_2 ~ interview_age,
data=combineddata)
summary(null)
ggplot(subset, aes(x=interview_age, y=auc_2)) + geom_point()
restingstate_fopa_acc_r=lm(auc_2 ~ #interview_age +
rsfmri_cor_ngd_fopa_scs_aarh,
data=combinedata)
restingstate_fopa_acc_r=lm(auc_2 ~ #interview_age +
rsfmri_cor_ngd_fopa_scs_aarh,
data=combineddata)
summary(restingstate_fopa_acc_r)
restingstate_fopa_acc_l=lm(auc_2 ~ #interview_age +
rsfmri_cor_ngd_fopa_scs_aalh,
data=combineddata)
summary(restingstate_fopa_acc_l)
#default to frontoparietal
restingstate_default=lm(auc_2 ~ #interview_age +
rsfmri_c_ngd_dt_ngd_fo,
data=combineddata)
summary(restingstate_default)
deprivation=lm(auc_2 ~ reshist_addr1_adi_perc,
data=combineddata)
summary(deprivation)
famadversitymod=lm(auc_2 ~ sum,
data=combineddata)
summary(famadversitymod)
